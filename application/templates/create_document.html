{% extends "base.html" %}

{% block title %}Створення Документа{% endblock %}

{% block head %}
    
{% endblock %}

{% block content %}
    <div style="text-align: center; margin-bottom: 20px;">
        <h1>Створення Нового Облікового Документа</h1>
        <p><a href="{{ url_for('documents_list') }}">← Назад до списку</a></p>
    </div>
    
    {% if error %}
        <p class="error-message">{{ error }}</p>
    {% endif %}

    <form method="POST">
        {{ form.hidden_tag() }}

        <h2>Заголовок Документа</h2>
        
        <div class="form-group">
            {{ form.operation_type.label }} {{ form.operation_type(class="form-control") }} 
            
            {% if form.operation_type.errors %}
                {% for error in form.operation_type.errors %}
                    <span style="color: red;">[{{ error }}]</span>
                {% endfor %}
            {% endif %}
        </div>

        <div class="form-group">
            <label for="document_date">Дата Документа:</label>
            <input type="date" id="document_date" name="document_date" value="{{ today_date }}" required>
        </div>
        
        <div class="form-group">
            {{ form.counterparty_id.label }}
            {{ form.counterparty_id() }}
            {% if form.counterparty_id.errors %}
                {% for error in form.counterparty_id.errors %}
                    <span style="color: red;">[{{ error }}]</span>
                {% endfor %}
            {% endif %}
        </div>
        
        <div class="document-lines">
            <h2>Товари / Послуги</h2>
            
            <div id="lines-container">
                <div class="line-row" data-line-index="0">
                    <div>
                        <label for="lines-0-nomenclature_id">Номенклатура:</label>
                        <select id="lines-0-nomenclature_id" name="lines-0-nomenclature_id" required>
                            <option value="">Оберіть номенклатуру</option>
                            {% for item in nomenclatures %}
                            <option value="{{ item.nomenclature_id }}">{{ item.nomenclature_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div>
                        <label for="lines-0-quantity">Кількість:</label>
                        <input type="number" id="lines-0-quantity" name="lines-0-quantity" value="1" min="0.01" step="any" required>
                    </div>
                    <div>
                        <label for="lines-0-price_with_vat">Ціна:</label>
                        <input type="number" id="lines-0-price_with_vat" name="lines-0-price_with_vat" value="0.00" min="0.01" step="any" required>
                    </div>
                    <div class="remove-btn-container"></div>
                </div>
            </div>

            <button type="button" class="btn-add" onclick="addLine()">+ Додати Рядок</button> 
        </div>

        <div class="form-group" style="margin-top: 30px; border-top: 2px solid #333; padding-top: 20px;">
            <button type="submit" style="background-color: #28a745; color: white; font-size: 18px; font-weight: bold; cursor: pointer; padding: 12px;">
                Зберегти Документ
            </button>
        </div>
    </form>
{% endblock %}

{% block scripts %}
    
{% endblock %}